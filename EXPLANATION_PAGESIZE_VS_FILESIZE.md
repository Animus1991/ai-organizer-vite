# Î•Î¾Î®Î³Î·ÏƒÎ·: pageSize vs File Size / Text Length

## âŒ Î¤Î¿ `pageSize` Î”Î•Î ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï…

### Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ `pageSize`?

Î¤Î¿ `pageSize` ÎµÎ¯Î½Î±Î¹ **pagination parameter** Ï€Î¿Ï… ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹:
- **Î ÏŒÏƒÎ± uploads (Î±ÏÏ‡ÎµÎ¯Î±)** Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÎµ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î±
- **Î“Î¹Î± performance**: Î“Î¹Î± Î½Î± Î¼Î·Î½ Ï†Î¿ÏÏ„ÏÎ½Î¿Î½Ï„Î±Î¹ ÏŒÎ»Î± Ï„Î± uploads Î¼Î±Î¶Î¯

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:**
```
pageSize=100 â†’ Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ 100 uploads ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±
pageSize=1000 â†’ Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ 1000 uploads ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±
```

### Î¤Î¹ Î”Î•Î ÎµÎ¯Î½Î±Î¹ Ï„Î¿ `pageSize`?

âŒ **Î”Î•Î** Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… (file size)  
âŒ **Î”Î•Î** Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ Î¼Î®ÎºÎ¿Ï‚ Ï„Î¿Ï… ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… (text length)  
âŒ **Î”Î•Î** Ï€Î±ÏÎ±Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿  
âŒ **Î”Î•Î** ÎºÏŒÎ²ÎµÎ¹ Ï„Î¼Î®Î¼Î±Ï„Î± Ï„Î¿Ï… ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…  
âŒ **Î”Î•Î** Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î± segments  

---

## âœ… Î ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¿Î¯ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿Î¯

### 1. **File Size Limits** (ÎœÎ­Î³ÎµÎ¸Î¿Ï‚ Î‘ÏÏ‡ÎµÎ¯Î¿Ï…)

Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ `FILE_SIZE_LIMITS`:

```typescript
// src/lib/edgeCases.ts
FILE_SIZE_LIMITS = {
  'application/pdf': 50 * 1024 * 1024,      // 50MB
  'application/vnd.openxmlformats...': 25 * 1024 * 1024,  // 25MB (DOCX)
  'text/plain': 10 * 1024 * 1024,           // 10MB
  'default': 20 * 1024 * 1024,              // 20MB
}
```

**Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹:**
- ÎˆÎ½Î± PDF Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î­Ï‡ÏÎ¹ **50MB**
- ÎˆÎ½Î± DOCX Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î­Ï‡ÏÎ¹ **25MB**
- ÎˆÎ½Î± TXT Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î­Ï‡ÏÎ¹ **10MB**

### 2. **Text Extraction** (Î•Î¾Î±Î³Ï‰Î³Î® ÎšÎµÎ¹Î¼Î­Î½Î¿Ï…)

Î¤Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… ÎµÎ¾Î¬Î³ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿:
- âœ… **Î‘Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Ï€Î»Î®ÏÏ‰Ï‚** - ÏŒÎ»Î¿ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿
- âœ… **Î§Ï‰ÏÎ¯Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚** ÏƒÎµ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ Î® Î³ÏÎ±Î¼Î¼Î­Ï‚
- âœ… **Î§Ï‰ÏÎ¯Ï‚ Ï€Î±ÏÎ±Ï€Î¿Î¯Î·ÏƒÎ·** - Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:**
- ÎˆÎ½Î± Î±ÏÏ‡ÎµÎ¯Î¿ 10MB Î¼Îµ 500,000 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ â†’ **ÎŒÎ»Î¿Î¹ Î¿Î¹ 500,000 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚** Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹
- ÎˆÎ½Î± Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Îµ 10,000 Î³ÏÎ±Î¼Î¼Î­Ï‚ â†’ **ÎŒÎ»ÎµÏ‚ Î¿Î¹ 10,000 Î³ÏÎ±Î¼Î¼Î­Ï‚** Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹

### 3. **Segments** (Î¤Î¼Î®Î¼Î±Ï„Î±)

Î¤Î± segments Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ:
- âœ… **ÎŸÎ»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿** - Ï‡Ï‰ÏÎ¯Ï‚ ÎºÏŒÏˆÎ¹Î¼Î¿
- âœ… **Î”Ï…Î½Î±Î¼Î¹ÎºÎ¬** - Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿ Î¼Î®ÎºÎ¿Ï‚ Ï„Î¿Ï… ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…
- âœ… **Î§Ï‰ÏÎ¯Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚** - ÏŒÏƒÎ± Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:**
- ÎˆÎ½Î± Î­Î³Î³ÏÎ±Ï†Î¿ 500,000 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ â†’ **ÎŒÎ»Î¿ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿** â†’ **Segments** (Ï€.Ï‡. 90 segments)
- ÎšÎ¬Î¸Îµ segment Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ **Ï€Î»Î®ÏÎµÏ‚ Ï„Î¼Î®Î¼Î±** Ï„Î¿Ï… ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…

---

## ğŸ“Š Î£ÏÎ³ÎºÏÎ¹ÏƒÎ·

| Î Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ | Î¤Î¹ Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÎ¹ | Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± |
|------------|---------------|------------|
| `pageSize` | **Î ÏŒÏƒÎ± uploads** ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î± | 100 uploads ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± |
| `FILE_SIZE_LIMITS` | **ÎœÎ­Î³ÎµÎ¸Î¿Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï…** | PDF max 50MB |
| **ÎšÎ±Î½Î­Î½Î±Ï‚** | **ÎœÎ®ÎºÎ¿Ï‚ ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…** | Î‘Ï€ÎµÏÎ¹ÏŒÏÎ¹ÏƒÏ„Î¿ |
| **ÎšÎ±Î½Î­Î½Î±Ï‚** | **Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ segments** | Î‘Ï€ÎµÏÎ¹ÏŒÏÎ¹ÏƒÏ„Î¿ |

---

## ğŸ” ÎšÏÎ´Î¹ÎºÎ±Ï‚ Ï€Î¿Ï… Ï„Î¿ ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÎ½ÎµÎ¹

### Backend: `list_uploads` endpoint
```python
# backend/src/ai_organizer/api/routes/upload.py
@router.get("/uploads")
def list_uploads(
    page: int = Query(default=1, ge=1),
    pageSize: int = Query(default=50, ge=1, le=1000),  # â† ÎœÏŒÎ½Î¿ Î³Î¹Î± pagination
    ...
):
    # Î•Ï€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î»Î¯ÏƒÏ„Î± uploads (metadata)
    # Î”Î•Î ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½
    uploads = session.exec(
        select(Upload)
        .where(Upload.user_id == user.id)
        .limit(pageSize)  # â† ÎœÏŒÎ½Î¿ Î³Î¹Î± pagination
    ).all()
```

### Text Extraction: `_write_processed_text`
```python
# backend/src/ai_organizer/api/routes/upload.py
def _write_processed_text(upload_id: int, original_name: str, text: str) -> str:
    """
    Writes processed text ONLY when parse succeeded.
    Returns processed_path string.
    """
    # Î‘Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ ÎŸÎ›ÎŸ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ - Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚
    processed_dir.mkdir(parents=True, exist_ok=True)
    processed_file = processed_dir / f"{base}.txt"
    processed_file.write_text(text, encoding="utf-8")  # â† ÎŸÎ»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ text
    return str(processed_file)
```

---

## âœ… Î£Ï…Î¼Ï€Î­ÏÎ±ÏƒÎ¼Î±

**Î¤Î¿ `pageSize` ÎµÎ¯Î½Î±Î¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± pagination Ï„Î·Ï‚ Î»Î¯ÏƒÏ„Î±Ï‚ uploads.**

**Î”Î•Î ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹:**
- Î¤Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… (Î±Ï…Ï„ÏŒ Ï€ÎµÏÎ¹Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ `FILE_SIZE_LIMITS`)
- Î¤Î¿ Î¼Î®ÎºÎ¿Ï‚ Ï„Î¿Ï… ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… (Î±Ï€ÎµÏÎ¹ÏŒÏÎ¹ÏƒÏ„Î¿)
- Î¤Î± segments (Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿)

**Î¤Î¿ Î­Î³Î³ÏÎ±Ï†ÏŒ ÏƒÎ¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Ï€Î»Î®ÏÏ‰Ï‚, Ï‡Ï‰ÏÎ¯Ï‚ Ï€Î±ÏÎ±Ï€Î¿Î¯Î·ÏƒÎ·!** âœ…

